# NERO SENSE - SYSTEM B (Lidar Radar)
**High-Performance Tactical Radar Unit**

## 1. Overview
The **Nero Sense System B** is a standalone, high-precision radar unit designed for the Nero Robotics ecosystem. It utilizes a **Time-of-Flight (TOF) Laser Sensor** to map its surroundings with millimeter accuracy and displays the data on a circular **Retina-Grade IPS Display**.

## 2. Hardware Specs
*   **MCU**: Wemos D1 Mini (ESP8266) @ 80MHz
*   **Display**: 1.28" Round IPS LCD (GC9A01 Driver) - 240x240 px
*   **Sensor**: VL53L1X (TOF0400C) Laser Distance Sensor (Range: 4m)
*   **Actuator**: SG90 Micro Servo (Modified for 180Â° sweep)

## 3. Wiring Configuration
| Component | Pin Name | Wemos Pin | Description |
| :--- | :--- | :--- | :--- |
| **Display** | VCC | 3.3V | Power |
| | GND | GND | Ground |
| | SCL | D5 (GPIO 14) | SPI Clock |
| | SDA | D7 (GPIO 13) | SPI MOSI |
| | RES | D0 (GPIO 16) | Reset |
| | DC | D3 (GPIO 0) | Data/Command |
| | CS | D8 (GPIO 15) | Chip Select |
| **Sensor** | VCC | 3.3V | Power |
| | GND | GND | Ground |
| | SDA | D2 (GPIO 4) | I2C Data |
| | SCL | D1 (GPIO 5) | I2C Clock |
| **Servo** | PWM | D6 (GPIO 12) | Control Signal |
| | VCC | 5V | Power (Direct from USB) |
| | GND | GND | Ground |

## 4. Firmware Features (Final Version)

### A. Cinematic Boot Sequence
A procedural animation sequence that plays on startup:
1.  **Singularity**: A single white pixel expands.
2.  **Pulse**: Organic "heartbeat" animation.
3.  **Ignition**: Cyan ring wipe clears the screen.
4.  **Identity**: "NERO ROBOTICS" logo with glitch effect.
5.  **Flash**: White screen flash before radar activation.

### B. "Tron" Visualization Engine
*   **Connected Contours**: Instead of drawing unconnected dots, the engine draws continuous **Cyan Lines** connecting measurement points, creating a solid "wall" effect.
*   **Jump Filter**: Prevents connecting foreground objects to background walls (Threshold: 300mm).
*   **Hatched Shadows**: Casts dark **Navy Blue** shadow lines behind detected objects to the edge of the screen, simulating occlusion.
*   **Data Smoothing**: Implements a **Low Pass Filter** (70% Old / 30% New) to eliminate sensor jitter and create fluid motion.
*   **Active Clearing**: The red scanner line actively wipes old data before drawing new readings.

### C. Hybrid Network Manager
*   **Static IP**: `192.168.178.71` (Gateway: `192.168.178.1`)
*   **Fallback Mode**: Attempts to connect for 5 seconds. If WiFi fails, it seamlessly switches to **Standalone Mode** (Red Dot) without blocking the radar loop.
*   **WebSocket**: Broadcasts JSON data `{"angle": X, "distance": Y}` to the Nero Dashboard.

### D. Stability Systems
*   **I2C Bus Reset**: Manually toggles the SCL line on startup to unstick any frozen I2C slaves.
*   **Retry Loop**: Attempts to initialize the sensor 5 times before reporting a failure.
*   **Watchdog Prevention**: Uses non-blocking `millis()` timers for all servo and sensor operations.

## 5. Installation
1.  **Install Libraries** (via Arduino Library Manager):
    *   `TFT_eSPI` (Bodmer)
    *   `VL53L1X` (Pololu)
    *   `Servo` (Built-in)
    *   `WebSockets` (Markus Sattler)
2.  **Configure TFT_eSPI**:
    *   Edit `User_Setup.h` in the library folder.
    *   Select `GC9A01_DRIVER`.
    *   Map pins as shown in the Wiring section.
3.  **Upload**:
    *   Board: "LOLIN(WEMOS) D1 R2 & mini"
    *   Upload Speed: 921600
    *   Flash Size: 4MB (FS:2MB OTA:~1019KB)

---
*Generated by Antigravity for Nero Robotics*
*Date: 2025-12-14*
